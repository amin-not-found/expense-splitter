var ee=Object.defineProperty;var te=(t,e,n)=>e in t?ee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var g=(t,e,n)=>(te(t,typeof e!="symbol"?e+"":e,n),n);import{j as ne,e as re,w as W}from"./singletons.4caf7dee.js";class se{constructor(){g(this,"config",new Map)}get darkTheme(){const e=localStorage.getItem("dark");return!!(e&&e==="true")}get currentEvent(){const e=parseInt(localStorage.getItem("current-event")??"-1");return e||-1}setCurrentEvent(e){localStorage.setItem("current-event",e.toString())}toggleTheme(){localStorage.setItem("dark",(!this.darkTheme).toString())}}const ie=(t,e)=>e.some(n=>t instanceof n);let F,U;function oe(){return F||(F=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ae(){return U||(U=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const z=new WeakMap,L=new WeakMap,Y=new WeakMap,A=new WeakMap,j=new WeakMap;function ce(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(v(t.result)),s()},a=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&z.set(n,t)}).catch(()=>{}),j.set(e,t),e}function ue(t){if(L.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),s()},a=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});L.set(t,e)}let O={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return L.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Y.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return v(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function he(t){O=t(O)}function fe(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(C(this),e,...n);return Y.set(r,e.sort?e.sort():[e]),v(r)}:ae().includes(t)?function(...e){return t.apply(C(this),e),v(z.get(this))}:function(...e){return v(t.apply(C(this),e))}}function le(t){return typeof t=="function"?fe(t):(t instanceof IDBTransaction&&ue(t),ie(t,oe())?new Proxy(t,O):t)}function v(t){if(t instanceof IDBRequest)return ce(t);if(A.has(t))return A.get(t);const e=le(t);return e!==t&&(A.set(t,e),j.set(e,t)),e}const C=t=>j.get(t);function de(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=v(a);return r&&a.addEventListener("upgradeneeded",u=>{r(v(a.result),u.oldVersion,u.newVersion,v(a.transaction),u)}),n&&a.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),o.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const pe=["get","getKey","getAll","getAllKeys","count"],me=["put","add","delete","clear"],y=new Map;function $(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(y.get(e))return y.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=me.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||pe.includes(n)))return;const i=async function(a,...o){const u=this.transaction(a,s?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(o.shift())),(await Promise.all([c[n](...o),s&&u.done]))[0]};return y.set(e,i),i}he(t=>({...t,get:(e,n,r)=>$(e,n)||t.get(e,n,r),has:(e,n)=>!!$(e,n)||t.has(e,n)}));class V{constructor(e=Date.now(),n="",r=new Set,s=[],i=[]){g(this,"openedTime");this.createdTime=e,this.name=n,this.attendees=r,this.expenses=s,this.evaluatedDebts=i,this.openedTime=this.createdTime}}var K=(t=>(t.Name="name",t.Opened="openedTime",t.Created="createdTime",t))(K||{});class Ee{constructor(){g(this,"dbName","expense-splitter");g(this,"dbVersion",1);g(this,"_db")}async initDB(){"indexedDB"in window&&(this._db=await de(this.dbName,this.dbVersion,{upgrade:this.upgradeDb}),console.log("[Database] initialized"))}confirmSupport(){if(this._db===void 0)throw"Indexeddb unsupported by browser"}upgradeDb(e,n){switch(n){case 0:{e.createObjectStore("people",{keyPath:"name"});const r=e.createObjectStore("events",{keyPath:"createdTime"});r.createIndex("name","name"),r.createIndex("createdTime","createdTime"),r.createIndex("openedTime","openedTime")}}}async createEvent(e){var s;this.confirmSupport();const n=Date.now();return await((s=this._db)==null?void 0:s.add("events",new V(n,e)))}async getEvent(e){var n;return this.confirmSupport(),await((n=this._db)==null?void 0:n.get("events",e))}async getEvents(e){var n;return this.confirmSupport(),await((n=this._db)==null?void 0:n.getAllFromIndex("events",e))}async updateEvent(e){var n;this.confirmSupport(),await((n=this._db)==null?void 0:n.put("events",e))}async addAttendee(e,n){var s,i,a;this.confirmSupport();const r=await((s=this._db)==null?void 0:s.get("people",e));if(!r){(i=this._db)==null||i.add("people",{name:e,events:[n.createdTime]});return}r.events.push(n.createdTime),(a=this._db)==null||a.put("people",r)}async removeAttendee(e,n){var s,i,a;this.confirmSupport();const r=await((s=this._db)==null?void 0:s.get("people",e));if(!r)throw"Such a person doesn't exist";if(r.events=r.events.filter(o=>o!=n.createdTime),r.events.length<1){(i=this._db)==null||i.delete("people",e);return}(a=this._db)==null||a.put("people",r)}}const ve=ne("goto");var ge=P;function P(t){let e=t;var n={}.toString.call(t).slice(8,-1);if(n=="Set")return new Set([...t].map(s=>P(s)));if(n=="Map")return new Map([...t].map(s=>[P(s[0]),P(s[1])]));if(n=="Date")return new Date(t.getTime());if(n=="RegExp")return RegExp(t.source,we(t));if(n=="Array"||n=="Object"){e=Array.isArray(t)?[]:{};for(var r in t)e[r]=P(t[r])}return e}function we(t){if(typeof t.source.flags=="string")return t.source.flags;var e=[];return t.global&&e.push("g"),t.ignoreCase&&e.push("i"),t.multiline&&e.push("m"),t.sticky&&e.push("y"),t.unicode&&e.push("u"),e.join("")}var xe=20,be=1,w=1e6,q=1e6,De=-7,_e=21,Se=!1,M="[big.js] ",x=M+"Invalid ",B=x+"decimal places",Ie=x+"rounding mode",H=M+"Division by zero",h={},p=void 0,Pe=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function X(){function t(e){var n=this;if(!(n instanceof t))return e===p?X():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(x+"value");e=e===0&&1/e<0?"-0":String(e)}Me(n,e)}n.constructor=t}return t.prototype=h,t.DP=xe,t.RM=be,t.NE=De,t.PE=_e,t.strict=Se,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function Me(t,e){var n,r,s;if(!Pe.test(e))throw Error(x+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),s=e.length,r=0;r<s&&e.charAt(r)=="0";)++r;if(r==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=s;)t.c[n++]=+e.charAt(r++)}return t}function b(t,e,n,r){var s=t.c;if(n===p&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(Ie);if(e<1)r=n===3&&(r||!!s[0])||e===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==p))),s.length=1,r?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(r=n===1&&s[e]>=5||n===2&&(s[e]>5||s[e]===5&&(r||s[e+1]!==p||s[e-1]&1))||n===3&&(r||!!s[0]),s.length=e,r){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function S(t,e,n){var r=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&n?"-"+s:s}h.abs=function(){var t=new this.constructor(this);return t.s=1,t};h.cmp=function(t){var e,n=this,r=n.c,s=(t=new n.constructor(t)).c,i=n.s,a=t.s,o=n.e,u=t.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-a:0;if(i!=a)return i;if(e=i<0,o!=u)return o>u^e?1:-1;for(a=(o=r.length)<(u=s.length)?o:u,i=-1;++i<a;)if(r[i]!=s[i])return r[i]>s[i]^e?1:-1;return o==u?0:o>u^e?1:-1};h.div=function(t){var e=this,n=e.constructor,r=e.c,s=(t=new n(t)).c,i=e.s==t.s?1:-1,a=n.DP;if(a!==~~a||a<0||a>w)throw Error(B);if(!s[0])throw Error(H);if(!r[0])return t.s=i,t.c=[t.e=0],t;var o,u,c,m,f,E=s.slice(),T=o=s.length,Q=r.length,l=r.slice(0,o),d=l.length,D=t,k=D.c=[],N=0,I=a+(D.e=e.e-t.e)+1;for(D.s=i,i=I<0?0:I,E.unshift(0);d++<o;)l.push(0);do{for(c=0;c<10;c++){if(o!=(d=l.length))m=o>d?1:-1;else for(f=-1,m=0;++f<o;)if(s[f]!=l[f]){m=s[f]>l[f]?1:-1;break}if(m<0){for(u=d==o?s:E;d;){if(l[--d]<u[d]){for(f=d;f&&!l[--f];)l[f]=9;--l[f],l[d]+=10}l[d]-=u[d]}for(;!l[0];)l.shift()}else break}k[N++]=m?c:++c,l[0]&&m?l[d]=r[T]||0:l=[r[T]]}while((T++<Q||l[0]!==p)&&i--);return!k[0]&&N!=1&&(k.shift(),D.e--,I--),N>I&&b(D,I,n.RM,l[0]!==p),D};h.eq=function(t){return this.cmp(t)===0};h.gt=function(t){return this.cmp(t)>0};h.gte=function(t){return this.cmp(t)>-1};h.lt=function(t){return this.cmp(t)<0};h.lte=function(t){return this.cmp(t)<1};h.minus=h.sub=function(t){var e,n,r,s,i=this,a=i.constructor,o=i.s,u=(t=new a(t)).s;if(o!=u)return t.s=-u,i.plus(t);var c=i.c.slice(),m=i.e,f=t.c,E=t.e;if(!c[0]||!f[0])return f[0]?t.s=-u:c[0]?t=new a(i):t.s=1,t;if(o=m-E){for((s=o<0)?(o=-o,r=c):(E=m,r=f),r.reverse(),u=o;u--;)r.push(0);r.reverse()}else for(n=((s=c.length<f.length)?c:f).length,o=u=0;u<n;u++)if(c[u]!=f[u]){s=c[u]<f[u];break}if(s&&(r=c,c=f,f=r,t.s=-t.s),(u=(n=f.length)-(e=c.length))>0)for(;u--;)c[e++]=0;for(u=e;n>o;){if(c[--n]<f[n]){for(e=n;e&&!c[--e];)c[e]=9;--c[e],c[n]+=10}c[n]-=f[n]}for(;c[--u]===0;)c.pop();for(;c[0]===0;)c.shift(),--E;return c[0]||(t.s=1,c=[E=0]),t.c=c,t.e=E,t};h.mod=function(t){var e,n=this,r=n.constructor,s=n.s,i=(t=new r(t)).s;if(!t.c[0])throw Error(H);return n.s=t.s=1,e=t.cmp(n)==1,n.s=s,t.s=i,e?new r(n):(s=r.DP,i=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=s,r.RM=i,this.minus(n.times(t)))};h.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};h.plus=h.add=function(t){var e,n,r,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var a=s.e,o=s.c,u=t.e,c=t.c;if(!o[0]||!c[0])return c[0]||(o[0]?t=new i(s):t.s=s.s),t;if(o=o.slice(),e=a-u){for(e>0?(u=a,r=c):(e=-e,r=o),r.reverse();e--;)r.push(0);r.reverse()}for(o.length-c.length<0&&(r=c,c=o,o=r),e=c.length,n=0;e;o[e]%=10)n=(o[--e]=o[e]+c[e]+n)/10|0;for(n&&(o.unshift(n),++u),e=o.length;o[--e]===0;)o.pop();return t.c=o,t.e=u,t};h.pow=function(t){var e=this,n=new e.constructor("1"),r=n,s=t<0;if(t!==~~t||t<-q||t>q)throw Error(x+"exponent");for(s&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return s?n.div(r):r};h.prec=function(t,e){if(t!==~~t||t<1||t>w)throw Error(x+"precision");return b(new this.constructor(this),t,e)};h.round=function(t,e){if(t===p)t=0;else if(t!==~~t||t<-w||t>w)throw Error(B);return b(new this.constructor(this),t+this.e+1,e)};h.sqrt=function(){var t,e,n,r=this,s=r.constructor,i=r.s,a=r.e,o=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(M+"No square root");i=Math.sqrt(r+""),i===0||i===1/0?(e=r.c.join(""),e.length+a&1||(e+="0"),i=Math.sqrt(e),a=((a+1)/2|0)-(a<0||a&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+a)):t=new s(i+""),a=t.e+(s.DP+=4);do n=t,t=o.times(n.plus(r.div(n)));while(n.c.slice(0,a).join("")!==t.c.slice(0,a).join(""));return b(t,(s.DP-=4)+t.e+1,s.RM)};h.times=h.mul=function(t){var e,n=this,r=n.constructor,s=n.c,i=(t=new r(t)).c,a=s.length,o=i.length,u=n.e,c=t.e;if(t.s=n.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=u+c,a<o&&(e=s,s=i,i=e,c=a,a=o,o=c),e=new Array(c=a+o);c--;)e[c]=0;for(u=o;u--;){for(o=0,c=a+u;c>u;)o=e[c]+i[u]*s[c-u-1]+o,e[c--]=o%10,o=o/10|0;e[c]=o}for(o?++t.e:e.shift(),u=e.length;!e[--u];)e.pop();return t.c=e,t};h.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==p){if(t!==~~t||t<0||t>w)throw Error(B);for(n=b(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return S(n,!0,!!r)};h.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==p){if(t!==~~t||t<0||t>w)throw Error(B);for(n=b(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return S(n,!1,!!r)};h[Symbol.for("nodejs.util.inspect.custom")]=h.toJSON=h.toString=function(){var t=this,e=t.constructor;return S(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};h.toNumber=function(){var t=Number(S(this,!0,!0));if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(M+"Imprecise conversion");return t};h.toPrecision=function(t,e){var n=this,r=n.constructor,s=n.c[0];if(t!==p){if(t!==~~t||t<1||t>w)throw Error(x+"precision");for(n=b(new r(n),t,e);n.c.length<t;)n.c.push(0)}return S(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)};h.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(M+"valueOf disallowed");return S(t,t.e<=e.NE||t.e>=e.PE,!0)};var R=X();function*Be(t,e){for(;t<=e;++t)yield t}function Te(t){return t[t.length-1]}function*G(t,e,n=[]){const r=n.length;if(r===e){yield n;return}for(const s of Be(r?Te(n)+1:0,t-e+r))yield*G(t,e,n.concat(s))}function*ke(t,e){for(const n of G(t.length,e))yield n.map(r=>t[r])}class _{constructor(e,n=0,r="",...s){g(this,"debtors");this.name=e,this.amount=n,this.payer=r,this.debtors=new Set(s)}}class Ne{constructor(e,n,r){this.giver=e,this.receiver=n,this.amount=r}}class J{constructor(e){this.event=e}fromDBObj(e){this.event=e}addPerson(e){return e?this.event.attendees.has(e)?`A person with name "${e}" already exists`:(this.event.attendees.add(e),null):"Person name can't be empty."}removePerson(e){for(let n=0;n<this.event.expenses.length;n++){const r=this.event.expenses[n];r.debtors.delete(e),r.payer===e&&(this.event.expenses.splice(n,1),n--)}this.event.attendees.delete(e)}addExpense(e){const n=this.validateExpense(e);if(n)return n;if(this.event.expenses.some(r=>r.name===e.name))return`An expense with "${e.name}" as name already exists`;this.event.expenses.push(e)}replaceExpense(e,n){const r=this.validateExpense(n);if(r)return r;const s=this.event.expenses.findIndex(i=>i.name==e);if(s<0)return`Expense with ${e} as name doesn't exist`;this.event.expenses.splice(s,1,n)}deleteExpense(e){const n=this.event.expenses.findIndex(r=>r.name==e);if(n<0)return`Expense with ${e} as name name doesn't exist`;this.event.expenses.splice(n,1)}validateExpense(e){if(!e.payer)return"Please select someone as the payer";if(!e.amount)return"Please enter an amount for the expense";if(!e.debtors.size)return"Please enter at least one debtor";if(e.debtors.size==1&&e.debtors.has(e.payer))return"There should be at least one debtor other than the payer"}getNetBalances(){const e=new Map;this.event.attendees.forEach(n=>e.set(n,R(0)));for(const n of this.event.expenses){const r=R(n.amount);e.set(n.payer,e.get(n.payer).minus(r));const s=r.div(n.debtors.size);n.debtors.forEach(i=>e.set(i,e.get(i).add(s)))}return e}naiveSettle(e){const n=[];for(;e.length>1;){const r=e.length-1,s=e[r].name,i=e[0].name;let a=0;switch(e[0].amount.abs().cmp(e[r].amount.abs())){case 0:a=e[r].amount.toNumber(),e.splice(r,1),e.splice(0,1);break;case-1:a=e[0].amount.abs().toNumber(),e[r].amount=e[r].amount.add(e[0].amount),e.splice(0,1);break;case 1:a=e[r].amount.toNumber(),e[0].amount=e[0].amount.add(e[r].amount),e.splice(r,1);break}n.push(new Ne(s,i,a))}return n}settleBalances(e){const n=[];e=e.filter(i=>!i.amount.eq(0)),e=e.sort((i,a)=>i.amount.minus(a.amount).toNumber());let r=e.length,s=2;for(;s<r-2;){let i,a;for(const o of ke(e,s)){if(i=!1,a=o.reduce((u,c)=>u.add(c.amount),R(0)),a.eq(0)){n.concat(this.naiveSettle(o));for(const u of o)e.splice(e.indexOf(u),1),--r,i=!0}if(i){--s;break}}++s}return n.concat(this.naiveSettle(e))}evaluate(){const e=Array.from(this.getNetBalances(),([n,r])=>({name:n,amount:r}));return this.settleBalances(e)}}var Ae=(t=>(t[t.None=0]="None",t[t.CreateEvent=1]="CreateEvent",t[t.CreateExpense=2]="CreateExpense",t[t.EditExpense=3]="EditExpense",t[t.ShowExpense=4]="ShowExpense",t[t.DeleteExpense=5]="DeleteExpense",t[t.RemovePerson=6]="RemovePerson",t))(Ae||{});class Ce{constructor(e=new J(new V),n=0,r=[],s=null,i=null,a=null,o=new Ee){this.splitter=e,this._mode=n,this._data=r,this._currentExpense=s,this._backupExpense=i,this._installEvent=a,this._db=o}get mode(){return this._mode}get data(){return this._data}get expenses(){return this.splitter.event.expenses}get people(){return this.splitter.event.attendees}get currentExpense(){return this._currentExpense}get installEvent(){return this._installEvent}setState(e,n){this._mode=e,this._data=n}setNormalState(){this.setState(0,[])}eventDialog(){this.setState(1,[])}updateEvent(){this._db.updateEvent(this.splitter.event)}async createEvent(e){if(this.mode!==1)return;const n=await this._db.createEvent(e);if(!n)throw"Couldn't create event";Oe.setCurrentEvent(n),await this.initEvent(n)}async initEvent(e){const n=await this._db.getEvent(e);if(!n)throw"Couldn't fetch created event";n.openedTime=Date.now(),this._db.updateEvent(n),this.splitter.fromDBObj(n),console.log("[Database] Loaded the event"),this.goToRoute("/app/event"),this.setNormalState()}async getEvents(e=K.Created){return await this._db.getEvents(e)}addPerson(e){const n=this.splitter.addPerson(e);return n||(this.updateEvent(),this._db.addAttendee(e,this.splitter.event),n)}removePerson(e){return this.setState(6,[e])}killPeople(e){throw"Should be running on dev to call killPeople."}createExpense(){this._currentExpense||(this._currentExpense=new _(this.expenses.length.toString())),this.setState(2,[])}editExpense(e){this._backupExpense=this._currentExpense,this._currentExpense=ge(e),this.setState(3,[e.name])}submitExpense(){let e;if(!this._currentExpense)return"Something went wrong";switch(this._mode){case 2:e=this.splitter.addExpense(this._currentExpense);break;case 3:e=this.splitter.replaceExpense(this._data[0],this._currentExpense);break}if(e)return e;this.flushExpenseMemory(),this.setNormalState(),this._db.updateEvent(this.splitter.event)}deleteExpenses(...e){this.setState(5,e)}confirmDelete(){switch(this._mode){case 5:this._data.forEach(e=>{this.splitter.deleteExpense(e)});break;case 6:this._data.forEach(e=>{this.splitter.removePerson(e),this._db.removeAttendee(e,this.splitter.event)});break;default:return}this.updateEvent()}evaluateExpenses(){var r;const e=new Map;for(const s of this.splitter.event.attendees)e.set(s,[]);const n=this.splitter.evaluate();for(const s of n)(r=e.get(s.giver))==null||r.push(s);return e}flushExpenseMemory(){this._currentExpense=this._backupExpense,this._backupExpense=null}goToRoute(e){e=e.startsWith("/")?e:`/${e}`,ve(`${re}${e}`)}dismissModal(){this._mode==3&&this.flushExpenseMemory(),this.setNormalState()}setInstallEvent(e){this._installEvent=e}async initDB(){await this._db.initDB()}}function ye(){const t=new J(new V);t.addPerson("MEe"),t.addPerson("MEe2"),t.addPerson("YoU"),t.addPerson("ThEy"),t.addPerson("uS");let e;return e=new _("test",1e4,"MEe","MEe2"),t.addExpense(e),e=new _("test1",1e4,"MEe2","MEe2","YoU"),t.addExpense(e),e=new _("test2",347800,"YoU","MEe","MEe2","YoU","uS","ThEy"),t.addExpense(e),e=new _("test3",123456,"ThEy","MEe","MEe2","YoU"),t.addExpense(e),e=new _("test4",123456,"uS","ThEy","MEe","MEe2","YoU"),t.addExpense(e),t}function Z(t){return e=>(...n)=>{let r;return t(s=>(r=s[e](...n),s)),r}}function Re(){const{subscribe:t,update:e}=W(new Ce(ye())),n=Z(e),r={eventDialog:n("eventDialog"),createEvent:n("createEvent"),initEvent:n("initEvent"),addPerson:n("addPerson"),removePerson:n("removePerson"),killPeople:n("killPeople"),createExpense:n("createExpense"),submitExpense:n("submitExpense"),editExpense:n("editExpense"),deleteExpenses:n("deleteExpenses"),confirmDelete:n("confirmDelete"),dismissModal:n("dismissModal"),evaluateExpenses:n("evaluateExpenses"),setInstallEvent:n("setInstallEvent")};return{subscribe:t,...r}}function Le(){const{subscribe:t,update:e}=W(new se),n=Z(e),r={toggleTheme:n("toggleTheme"),setCurrentEvent:n("setCurrentEvent")};return{subscribe:t,...r}}const Fe=Re(),Oe=Le();export{K as E,Ae as M,Oe as c,Fe as m};
